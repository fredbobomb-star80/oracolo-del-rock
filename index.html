<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chiedilo all‚ÄôOracolo del Rock</title>

  <style>
    :root{
      --bg:#0b0b0f;
      --text:#eee;
      --panel:#111218;
      --panel2:#1b1b22;
      --border:#333;
      --neon-blue:#00c8ff;
      --neon-pink:#ff3ccf;
    }

    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,Arial,sans-serif;
      text-align:center;
    }

    /* HERO con immagine oracolo intera */
    .hero{
      width:100%;
      display:flex;
      justify-content:center;
      padding:10px 0 0;
      background: radial-gradient(circle at top, #120018, #050507 70%);
    }
    .hero-img{
      width:100%;
      max-width:980px;     /* cos√¨ si vede tutta senza tagli */
      height:auto;
      display:block;
    }

    /* Contenuto sotto immagine */
    .wrap{
      max-width:920px;
      margin:0 auto;
      padding:18px 16px 40px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      box-sizing:border-box;
    }

    /* iframe youtube pi√π ‚Äúmonitorino‚Äù */
    #yt{
      width:100%;
      display:flex;
      justify-content:center;
    }
    iframe{
      width:100%;
      max-width:720px;
      aspect-ratio:16/9;
      border:3px solid var(--neon-blue);
      border-radius:14px;
      background:#111;
      box-shadow:0 0 18px rgba(0,200,255,.35);
    }

    /* pulsanti principali */
    .btns{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:6px;
      flex-wrap:wrap;
    }
    button, a.btn{
      padding:12px 16px;
      border-radius:12px;
      border:1px solid var(--border);
      background:var(--panel2);
      color:var(--text);
      cursor:pointer;
      text-decoration:none;
      font-weight:700;
    }
    button:hover, a.btn:hover{
      background:#262632;
    }

    /* bottone principale pi√π importante */
    #new{
      background:var(--neon-blue);
      color:#000;
      border:none;
      font-weight:900;
      padding:14px 20px;
      border-radius:999px;
      box-shadow:0 0 15px rgba(0,200,255,.55);
    }
    #new:hover{ filter:brightness(1.05); }

    /* social coerenti */
    .social-buttons{
      display:flex;
      justify-content:center;
      gap:12px;
      margin-top:2px;
      flex-wrap:wrap;
    }
    .social-btn{
      text-decoration:none;
      color:#ddd;
      background-color:#1a1a1a;
      border:2px solid var(--neon-pink);
      padding:8px 14px;
      border-radius:999px;
      transition:all .2s ease;
      font-size:14px;
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:800;
      box-shadow:0 0 12px rgba(255,60,207,.25);
    }
    .social-btn i{ font-size:16px; }
    .social-btn:hover{
      transform:scale(1.05);
      color:#fff;
    }
    .social-btn.youtube:hover{
      background:#ff0000; border-color:#ff0000;
    }
    .social-btn.facebook:hover{
      background:#1877f2; border-color:#1877f2;
    }
    .social-btn.instagram:hover{
      background:#e4405f; border-color:#e4405f;
    }

    .note{
      font-size:13px;
      opacity:.7;
      margin-top:6px;
    }
  </style>
</head>

<body>

  <!-- HERO sopra tutto -->
  <header class="hero">
    <img 
      src="https://raw.githubusercontent.com/fredbobomb-star80/oracolo-del-rock/main/214417.png"
      alt="Chiedilo all‚ÄôOracolo del Rock"
      class="hero-img"
    />
  </header>

  <!-- CONTENUTO -->
  <div class="wrap">
    <p>Pesca una tra le <strong>666 risposte</strong> che gli Dei del Rock hanno in serbo per te.</p>

    <div id="yt"></div>

    <div class="btns">
      <button id="new">üé≤ Nuova risposta</button>
      <a class="btn" id="open" target="_blank" rel="noopener">‚Üó Apri su YouTube</a>
    </div>

    <div class="social-buttons">
      <a href="https://youtube.com/@fred_bee" target="_blank" class="social-btn youtube">
        <i class="fab fa-youtube"></i> YouTube
      </a>
      <a href="https://www.facebook.com/profile.php?id=61583198656003" target="_blank" class="social-btn facebook">
        <i class="fab fa-facebook-f"></i> Facebook
      </a>
      <a href="https://www.instagram.com/chiedilo_all_oracolo_del_rock" target="_blank" class="social-btn instagram">
        <i class="fab fa-instagram"></i> Instagram
      </a>
    </div>

    <p class="note">Da un‚Äôidea originale di FredBee ‚Äî tutti i diritti riservati ¬©2025</p>
  </div>


  <script>
  // === CONFIG ===
  const API_KEY     = "AIzaSyDNsQKEvKwHOyZCJ0mojJS325Sbw6wX9as";
  const PLAYLIST_ID = "PL5l5Dspe3Obumt-dqGDVzM4bHp5Qc_vVx";
  const PAGE_SIZE   = 50;

  (function(){
    const s=document.createElement('script');
    s.src="https://www.youtube.com/iframe_api";
    document.head.appendChild(s);
  })();

  let player = null;
  let allIds = [];

  window.onYouTubeIframeAPIReady = () => {
    player = new YT.Player('yt', {
      height: '390',
      width: '640',
      playerVars: { modestbranding:1, rel:0 },
      events: { onReady: onReady }
    });
  };

  function onReady(){
    document.getElementById("new").addEventListener("click", playRandom);
    boot();
  }

  async function boot(){
    try{
      allIds = await fetchAllPlaylistIds(PLAYLIST_ID);
      if(!allIds.length) throw new Error("Playlist vuota o non accessibile");
      playRandom();
    }catch(err){
      console.error(err);
      alert("Errore nel caricare la playlist. Controlla API key e visibilit√† playlist.");
    }
  }

  async function fetchAllPlaylistIds(playlistId){
    let ids = [];
    let pageToken = "";
    do{
      const url = new URL("https://www.googleapis.com/youtube/v3/playlistItems");
      url.searchParams.set("key", API_KEY);
      url.searchParams.set("part", "snippet");
      url.searchParams.set("playlistId", playlistId);
      url.searchParams.set("maxResults", PAGE_SIZE);
      if(pageToken) url.searchParams.set("pageToken", pageToken);

      const res = await fetch(url.toString());
      if(!res.ok) throw new Error("HTTP "+res.status);
      const data = await res.json();

      const batch = (data.items||[])
        .map(i => i?.snippet?.resourceId?.videoId)
        .filter(Boolean);

      ids.push(...batch);
      pageToken = data.nextPageToken || "";
    } while(pageToken);

    return [...new Set(ids)];
  }

  function playRandom(){
    if(!player || !allIds.length) return;
    const idx = Math.floor(Math.random() * allIds.length);
    const id  = allIds[idx];

    player.loadVideoById(id);
    const open = document.getElementById("open");
    if(open) open.href = `https://www.youtube.com/watch?v=${id}&list=${PLAYLIST_ID}`;
  }
  </script>

  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>
</html>
